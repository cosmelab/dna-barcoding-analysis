#!/bin/bash
# DNA Barcoding Analysis - Complete Pipeline
# Runs: Assembly -> QC -> Alignment -> Phylogeny -> Species ID

set -e

# Default paths
INPUT_DIR="${1:-/workspace/data/my_sequences}"
OUTPUT_DIR="${2:-/workspace/results}"
REFERENCE="/workspace/data/reference/socal_mosquitoes.fasta"

echo "=================================================="
echo "   DNA Barcoding Analysis Pipeline"
echo "=================================================="
echo ""
echo "Input:  $INPUT_DIR"
echo "Output: $OUTPUT_DIR"
echo ""

# Run master pipeline
python /workspace/modules/master_pipeline.py \
    "$INPUT_DIR" \
    "$OUTPUT_DIR" \
    --reference "$REFERENCE"

echo ""
echo "=================================================="
echo "   Analysis Complete!"
echo "=================================================="
echo ""
echo "Open results in your browser:"
echo "  - QC Report: $OUTPUT_DIR/run_*/01_qc/qc_report.html"
echo "  - Tree: $OUTPUT_DIR/run_*/03_phylogeny/tree.png"
echo "  - Species ID: $OUTPUT_DIR/run_*/04_identification/identification_report.html"
echo ""
